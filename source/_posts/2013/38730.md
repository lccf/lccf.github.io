---
title: linux web服务器iptables设置
date: 2013-04-07 19:42
tags:
- iptables
- linux
- web
- php
- nginx
- web服务器
- 防火墙
categories: Linux
---

最近弄了个vps玩，配置lnmp想着配下iptables，总结了些经验，分享出来。

iptables设置

```bash
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT
# 先把所有规则打开，则否ssh可能直接断掉
 
iptables -F
iptables -X
# 清除已有规则
 
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
# 先把ssh端口加上
 
iptables -P INPUT DROP
iptables -P FORWARD DROP
# 设置INPUT和FORWARD为封锁
 
iptables -A INPUT -i lo -j ACCEPT
# 开启本地环路，使得ping 127.0.0.1这样的包以通过。php-fpm的http://127.0.0.1:9000可以使用
iptables -A INPUT -p icmp -j ACCEPT
# 允许其它机器ping这台服务器
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
# 允许自己发送包的返回通信，不开启这个，机器上面使用ping www.google.com这样的无法拼通
 
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
# 开放web端口
 
/etc/init.d/iptables save
# 保存设置
/etc/init.d/iptables restart
# 重启iptables
```
