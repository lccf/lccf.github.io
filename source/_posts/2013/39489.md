---
title: linux热拔插scsi硬盘
date: 2013-06-06 18:50
tags:
- linux热拔插硬盘
- linux添加scsi设备
categories: Linux
---

自己配置虚拟机，需要添加一块虚拟硬盘存放数据。虚拟机在更新软件，不想停机。学习了下热拔插硬盘的知识点

1.在虚拟机中创建虚拟磁盘并添加。

2.查看目前的磁盘信息
`cat /proc/scsi/scsi`

我返回的结果如下：

```
Attached devices:
Host: scsi1 Channel: 00 Id: 00 Lun: 00
  Vendor: NECVMWar Model: VMware IDE CDR10 Rev: 1.00
  Type:   CD-ROM                           ANSI  SCSI revision: 05
Host: scsi2 Channel: 00 Id: 00 Lun: 00
  Vendor: VMware,  Model: VMware Virtual S Rev: 1.0 
  Type:   Direct-Access                    ANSI  SCSI revision: 02
```

上面scsi1是光驱，scsi2那个设备是我的系统硬盘。

3.添加硬盘设备
`echo "scsi add-single-device 2 0 1 0" >> /proc/scsi/scsi`
数字参数说明：默认添加一块硬盘和原有系统硬盘是同一组的，第一个数字是scsi2这里的2，第二个是Channel这里是0，第三个是Id，在原有值上面加1，Lun默认为0。再用`cat /proc/scsi/scsi`可以看到硬盘信息，`fdisk -l`，可以看到/dev/sdb硬盘。

如果需要移除刚才添加的硬盘使用 `echo "scsi remove-single-device 2 0 1 0" >> /proc/scsi/scsi` 就可以，把add-single-device换成了remove-single-device，其它相同。

测试系统是 CentOS6.4_x64